<!DOCTYPE HTML>
<html lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

    <title>Guy Gafni</title>

    <meta name="author" content="Guy Gafni">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="shortcut icon" href="images/favicon/favicon.ico" type="image/x-icon">
    <link rel="stylesheet" type="text/css" href="stylesheet.css?v=20260129">
    <script type="application/ld+json">
    {
      "@context": "https://schema.org/",
      "@type": "Person",
      "name": "Guy Gafni",
      "url": "https://gafniguy.github.io/",
      "affiliation": [
        {
          "@type": "Organization",
          "name": "Pipio AI",
          "url": "https://pipio.ai"
        },
        {
          "@type": "Organization",
          "name": "Technical University of Munich",
          "url": "https://www.tum.de"
        }
      ],
      "sameAs": [
        "https://scholar.google.com/citations?user=PATfNhwAAAAJ",
        "https://de.linkedin.com/in/guy-gafni",
        "https://github.com/gafniguy"
      ],
      "jobTitle": "AI Researcher, CTO",
      "description": "Visual Computing and AI Researcher. Lead researcher for EditYourself, specializing in audio-driven video diffusion, visual dialog editing, and identity preservation."
    }
    </script>
<!-- Google Analytics loaded after consent -->
  </head>

  <body>
    <table style="width:100%;max-width:800px;border:0px;border-spacing:0px;border-collapse:separate;margin-right:auto;margin-left:auto;"><tbody>
      <tr style="padding:0px">
        <td style="padding:0px">
          <table style="width:100%;border:0px;border-spacing:0px;border-collapse:separate;margin-right:auto;margin-left:auto;"><tbody>
            <tr style="padding:0px">
              <td style="padding:2.5%;width:63%;vertical-align:middle">
                <p class="name" style="text-align: center;">
                  Guy Gafni
                </p>
                <p style="text-align:center">
                  <a class="social-link" href="https://scholar.google.com/citations?user=PATfNhwAAAAJ&hl=en">
                    <img src="https://cdn.simpleicons.org/googlescholar/1772d0" alt="Google Scholar" width="18" height="18">
                    <span>Scholar</span>
                  </a>
                  <span class="social-separator">¬∑</span>
                  <a class="social-link" href="https://x.com/gafniguy">
                    <img src="https://cdn.simpleicons.org/x/1772d0" alt="X (Twitter)" width="18" height="18">
                    <span>Twitter</span>
                  </a>
                  <span class="social-separator">¬∑</span>
                  <a class="social-link" href="https://github.com/gafniguy">
                    <img src="https://cdn.simpleicons.org/github/1772d0" alt="GitHub" width="18" height="18">
                    <span>Github</span>
                  </a>
                  <span class="social-separator">¬∑</span>
                  <a class="social-link" href="https://www.linkedin.com/in/guy-gafni/">
                    <img src="https://www.svgrepo.com/show/157006/linkedin.svg" alt="LinkedIn" width="18" height="18">
                    <span>LinkedIn</span>
                  </a>
                </p>
                <p style="text-align:center; margin-top:6px; margin-bottom:16px;">
                  <button class="contact-button" id="contact-button" type="button">Contact Me</button>
                </p>
                <p class="bio-pills" style="text-align:center;">
                  <span class="bio-pill">Video Diffusion</span>
                  <span class="bio-pill">Neural Rendering</span>
                  <span class="bio-pill">Human Avatars</span>
                  <span class="bio-pill">Pipio AI</span>
                </p>
                <p>
                  I'm <strong>Co-founder and CTO at <a href="https://pipio.ai/">Pipio AI</a></strong>, where we're building a foundation video model for talking humans. A video diffusion model with perfect lip sync, designed for video editing workflows.
                  <br>
                  <br>
                  Before that, I was a PhD candidate at the Technical University of Munich, <strong><a href="https://niessnerlab.org//">Visual Computing and AI Lab</a></strong>, where I was advised by Prof. Matthias Nie√üner (w/ Prof. Justus Thies) working on neural rendering, NeRFs, reconstruction and re-rendering of faces. 
                              </p>
                <p class="bio-location" style="text-align:center; margin-top:8px;">
                  üìç Munich, Germany
                </p>
              </td>
              <td style="padding:2.5%;width:37%;max-width:37%">
                <div class="profile-photo-frame">
                  <img style="width:100%;max-width:100%;object-fit: cover; border-radius: 50%;" alt="profile photo" src="images/portrait.jpg" class="profile-photo">
                </div>
              </td>
            </tr>
          </tbody></table>
          <table style="width:100%;border:0px;border-spacing:0px;border-collapse:separate;margin-right:auto;margin-left:auto;"><tbody>
              <tr>
              <td style="padding:16px;width:100%;vertical-align:middle">
                <h2>Research</h2>
                <p>
                  I'm interested in 3D Computer Vision and generative AI, specifically in video generation and editing of humans. I prefer generating and looking at pixels over improving a metric, and appreciate the use of 3D priors. Lately I've been heavily working on video diffusion models. <br> 
                  <br>
                  In 2023 I did a research internship at Meta Reality Labs in Zurich, working on 4D multiview reconstruction of humans. My last couple of projects have been around audio-driven facial re-enactment, hyper-realistic human avatars, dubbing and lip-sync. In the past, with CNNs and GANs, now heavily focused on DiTs and flow-matching.
                </p>
              </td>
            </tr>
          </tbody></table>
          <table style="width:100%;border:0px;border-spacing:0px 10px;border-collapse:separate;margin-right:auto;margin-left:auto;"><tbody>

<tr class="paper-row highlight-row" onmouseout="edityourself_stop()" onmouseover="edityourself_start()">
  <td style="padding:16px;width:20%;vertical-align:middle">
    <div class="one">
      <div class="two" id='edityourself_image'>
        <img src='images/edityourself_teaser.png' width=100%>
      </div>
      <img src='images/edityourself_teaser.png' width=100%>
    </div>
    <script type="text/javascript">
      function edityourself_start() {
        document.getElementById('edityourself_image').style.opacity = "1";
      }

      function edityourself_stop() {
        document.getElementById('edityourself_image').style.opacity = "0";
      }
      edityourself_stop()
    </script>
  </td>
  <td style="padding:8px;width:80%;vertical-align:middle">
    <a class="paper-title-link" href="https://edit-yourself.github.io">
      <span class="papertitle">EditYourself: Audio-Driven Generation and Manipulation of Talking Head Videos with Diffusion Transformers</span>
      <span class="new-badge">NEW</span>
    </a>
    <br>
    John Flynn,
    Wolfgang Paier,
    Dimitar Dinev,
    Sam Nhut Nguyen,
    Hayk Poghosyan,
    Manuel Toribio,
    Sandipan Banerjee,
    <strong>Guy Gafni</strong>
    <br>
    <span class="venue-tag">ArXiv</span> 2026
    <br>
    <a href="https://edit-yourself.github.io">project page</a>
    <span class="paper-separator">¬∑</span>
    <a href="https://arxiv.org/abs/2601.22127">arXiv</a>
    <p></p>
    <p>
    EditYourself is a diffusion-based video editing model for talking heads, enabling transcript-driven lip-syncing, insertion, removal and retiming of speech while preserving identity and visual fidelity.
    </p>
  </td>
</tr>

<tr class="paper-row" onmouseout="semantify_stop()" onmouseover="semantify_start()">
  <td style="padding:16px;width:20%;vertical-align:middle">
    <div class="one">
      <div class="two" id='semantify_image'>
        <img src='images/semantify_teaser.png' width=100%>
      </div>
      <img src='images/semantify_teaser.png' width=100%>
    </div>
    <script type="text/javascript">
      function semantify_start() {
        document.getElementById('semantify_image').style.opacity = "1";
      }

      function semantify_stop() {
        document.getElementById('semantify_image').style.opacity = "0";
      }
      semantify_stop()
    </script>
  </td>
  <td style="padding:8px;width:80%;vertical-align:middle">
    <a href="https://omergral.github.io/Semantify/">
      <span class="papertitle">Semantify: Simplifying the Control of 3D Morphable Models using CLIP</span>
    </a>
    <br>
    <a href="https://omergral.github.io/">Omer Gralnik</a>,
    <strong>Guy Gafni</strong>,
    <a href="https://www.idc.ac.il/en/pages/faculty.aspx?username=shamir">Ariel Shamir</a>
    <br>
    <span class="venue-tag">ICCV</span> 2023
    <br>
    <a href="https://omergral.github.io/Semantify/">project page</a>
    <span class="paper-separator">¬∑</span>
    <a href="https://doi.org/10.48550/arXiv.2308.07415">arXiv</a>
    <br>
    <a href="https://github.com/Omergral/Semantify" style="text-decoration: none;">
      <img src="https://img.shields.io/github/stars/Omergral/Semantify?style=social" alt="GitHub stars" style="vertical-align: middle; margin-right: 5px;">
      <img src="https://img.shields.io/github/forks/Omergral/Semantify?style=social" alt="GitHub forks" style="vertical-align: middle;">
    </a>
    <a href="https://scholar.google.com/citations?view_op=view_citation&hl=en&user=PATfNhwAAAAJ&citation_for_view=PATfNhwAAAAJ:d1gkVwhDpl0C" style="text-decoration: none; margin-left: 5px;" id="semantify-citation-link">
      <img src="https://img.shields.io/badge/Citations-Loading-blue" alt="Citations" style="vertical-align: middle;" id="semantify-citation-badge">
    </a>
    <p></p>
    <p>
    A self-supervised method that utilizes the power of CLIP VLM to simplify the control of 3D morphable models, by learning a mapping from natural language to a 3DMM basis.
    </p>
  </td>
</tr>

<tr class="paper-row" onmouseout="facial4d_stop()" onmouseover="facial4d_start()">
  <td style="padding:16px;width:20%;vertical-align:middle">
    <div class="one">
      <div class="two" id='facial4d_image'>
        <img src='images/nerface_teaser.png' width=100%>
      </div>
      <img src='images/nerface_teaser.png' width=100%>
    </div>
    <script type="text/javascript">
      function facial4d_start() {
        document.getElementById('facial4d_image').style.opacity = "1";
      }

      function facial4d_stop() {
        document.getElementById('facial4d_image').style.opacity = "0";
      }
      facial4d_stop()
    </script>
  </td>
  <td style="padding:8px;width:80%;vertical-align:middle">
    <a href="https://gafniguy.github.io/4D-Facial-Avatars/">
      <span class="papertitle">NeRFace: Dynamic Neural Radiance Fields for Monocular 4D Facial Avatar Reconstruction</span>
    </a>
    <br>
    <strong>Guy Gafni</strong>,
    <a href="https://justusthies.github.io/">Justus Thies</a>,
    <a href="https://zollhoefer.com/">Michael Zollh√∂fer</a>,
    <a href="https://www.niessnerlab.org/members/matthias-niessner/profile.html">Matthias Nie√üner</a>
    <br>
    <span class="venue-tag">CVPR Oral</span> 2021
    <br>
    <a href="https://gafniguy.github.io/4D-Facial-Avatars/">project page</a>
    <span class="paper-separator">¬∑</span>
    <a href="https://doi.org/10.48550/arXiv.2012.03065">arXiv</a>
    <br>
    <a href="https://github.com/gafniguy/4D-Facial-Avatars" style="text-decoration: none;">
      <img src="https://img.shields.io/github/stars/gafniguy/4D-Facial-Avatars?style=social" alt="GitHub stars" style="vertical-align: middle; margin-right: 5px;">
      <img src="https://img.shields.io/github/forks/gafniguy/4D-Facial-Avatars?style=social" alt="GitHub forks" style="vertical-align: middle;">
    </a>
    <a href="https://scholar.google.com/citations?view_op=view_citation&hl=en&user=PATfNhwAAAAJ&citation_for_view=PATfNhwAAAAJ:u5HHmVD_uO8C" style="text-decoration: none; margin-left: 5px;" id="facial4d-citation-link">
      <img src="https://img.shields.io/badge/Citations-Loading-blue" alt="Citations" style="vertical-align: middle;" id="facial4d-citation-badge">
    </a>
    <p></p>
    <p>
    The first method to combine NeRFs with 3DMM to reconstruct and re-render human faces.
    </p>
  </td>
</tr>

          </tbody></table>

          
					<table style="width:100%; margin:0 auto; border:0; border-spacing:0; padding:16px;"><tbody>
            <tr>
              <td>
                <h2>Miscellanea</h2>
              </td>
            </tr>
          </tbody></table>
          <table class="misc-table"><tbody>
            <tr class="misc-row">
              <td class="misc-label">üéì Academic Service</td>
              <td class="misc-content">
                Reviewer for ICCV, CVPR, SIGGRAPH and SIGGRAPH ASIA
              </td>
            </tr>
            <tr class="misc-row">
              <td class="misc-label">üë©‚Äçüè´ Teaching</td>
              <td class="misc-content">
                <ul>
                  <li><a href="https://niessner.github.io/I2DL/">Introduction to Deep Learning (TU Munich)</a></li>
                  <li>Seminar on Neural Radiance Fields (TU Munich)</li>
                  <li>Calculus 3 (TAU)</li>
                </ul>
              </td>
            </tr>
            <tr class="misc-row">
              <td class="misc-label">‚ú® Additional Stuff</td>
              <td class="misc-content">
                <ul>
                  <li>Common-Ground AI (Acq. by Apple in 2024) - Advisor to the CTO and R&D teams, guiding the research roadmap for 3D human reconstruction from mobile devices: faces/heads, meshing, neural rendering, dynamic animation of textures, hair reconstruction, and re-animation of the reconstructed geometry in real-time.</li>
                  <li>As a master student at TUM, I worked on neural rendering of point clouds for novel view synthesis (2019), and face replacement using CycleGAN in texture space of 3DMMs (2018)</li>
                  <li>I obtained my Bsc in Mathematics and Computer Science from Tel Aviv University (2017)</li>
                  <li>Worked at PTC on Subdivision Surfaces and processing of its control meshes, contributing to the Creo CAD software (2017)</li>
                </ul>
              </td>
            </tr>
          </tbody></table>
          <table style="width:100%;border:0px;border-spacing:0px;border-collapse:separate;margin-right:auto;margin-left:auto;"><tbody>
            <tr>
              <td style="padding:0px">
                <br>
                <p class="site-credit">
                  Feel free to steal this website's <a href="https://github.com/jonbarron/jonbarron_website">source code</a> from Jon Barron. <strong>Do not</strong> scrape the HTML from this page itself, as it includes analytics tags that you do not want on your own website &mdash; use the github code instead. Also, consider using <a href="https://leonidk.com/">Leonid Keselman</a>'s <a href="https://github.com/leonidk/new_website">Jekyll fork</a> of this page.
                </p>
                <p class="legal-links">
                  <button class="legal-link" type="button" id="legal-link">Impressum &amp; Datenschutzerkl√§rung</button>
                  <span class="legal-separator">¬∑</span>
                  <span class="legal-copy">¬© 2026 Guy Gafni ¬∑ All rights reserved</span>
                </p>
              </td>
            </tr>
          </tbody></table>
        </td>
      </tr>
    </table>
    <div class="contact-pane" id="contact-pane" aria-hidden="true" style="display:none;">
      <div class="contact-pane-content" role="dialog" aria-modal="true" aria-labelledby="contact-pane-title">
        <button class="contact-pane-close" id="contact-pane-close" type="button" aria-label="Close contact form">√ó</button>
        <h3 id="contact-pane-title">Contact</h3>
        <iframe
          src="https://docs.google.com/forms/d/e/1FAIpQLSfE7k8pR74Cgzl8Kcq_nGveRDg5AEqeLiWJuOQY5ADe7wpaqw/viewform?embedded=true"
          title="Contact form"
          frameborder="0"
          marginheight="0"
          marginwidth="0"
          loading="lazy">
          Loading‚Ä¶
        </iframe>
      </div>
    </div>
    <div class="legal-pane" id="legal-pane" aria-hidden="true">
      <div class="legal-pane-content" role="dialog" aria-modal="true" aria-labelledby="legal-pane-title">
        <button class="legal-pane-close" id="legal-pane-close" type="button" aria-label="Close legal information">√ó</button>
        <h3 id="legal-pane-title">Impressum &amp; Datenschutzerkl√§rung</h3>
        <div class="legal-pane-body" id="legal-pane-body">
          <p class="legal-subtitle">Angaben gem√§√ü ¬ß 5 DDG</p>
          <p><img class="address-image" id="address-obfuscated" alt="Address"></p>
          <p>Kontakt E-Mail: <img class="email-image" id="email-obfuscated" alt="Email address"></p>
          <p>Verantwortlich f√ºr den Inhalt nach ¬ß 18 Abs. 2 MStV: siehe Impressum oben.</p>
          <ol class="legal-list">
            <li>
              <strong>Datenschutz auf einen Blick</strong>
              <p>Wir behandeln Ihre personenbezogenen Daten vertraulich und entsprechend den gesetzlichen Datenschutzvorschriften sowie dieser Datenschutzerkl√§rung.</p>
            </li>
            <li>
              <strong>Verantwortlicher</strong>
              <p>Verantwortlich f√ºr die Datenverarbeitung auf dieser Website ist die im Impressum genannte Person.</p>
            </li>
            <li>
              <strong>Hosting und Datensicherheit</strong>
              <p><strong>SSL- bzw. TLS-Verschl√ºsselung</strong> Diese Website nutzt eine SSL- bzw. TLS-Verschl√ºsselung, um die √úbertragung vertraulicher Inhalte zu sch√ºtzen und sicherzustellen, dass Daten f√ºr Dritte nicht mitlesbar sind.</p>
              <p><strong>Hosting √ºber GitHub Pages</strong> Wir hosten unsere Website bei der GitHub Inc., 88 Colin P. Kelly Jr. St, San Francisco, CA 94107, USA. GitHub erfasst automatisch Log-Daten (z. B. IP-Adresse), um die Sicherheit des Dienstes zu gew√§hrleisten. Rechtsgrundlage ist unser berechtigtes Interesse (Art. 6 Abs. 1 lit. f DSGVO).</p>
              <p>Weitere Informationen: <a href="https://docs.github.com/en/site-policy/privacy-policies/github-privacy-statement">GitHub Privacy Statement</a>.</p>
            </li>
            <li>
              <strong>Analyse-Tools (Google Analytics 4 via Google Tag)</strong>
              <p>Wir nutzen Google Analytics 4 (GA4) der Google Ireland Limited, Gordon House, Barrow Street, Dublin 4, Irland (‚ÄûGoogle‚Äú). Die Datenerhebung erfolgt √ºber den Google Tag (gtag.js).</p>
              <p><strong>IP-Verarbeitung:</strong> Die IP-Adresse wird bei GA4 standardm√§√üig nicht protokolliert oder dauerhaft gespeichert. Sie wird lediglich kurzfristig zur Ermittlung des groben Standorts (Land/Stadt) verarbeitet und unmittelbar nach der √úbermittlung verworfen.</p>
              <p><strong>Zweck:</strong> Analyse des Nutzerverhaltens zur Optimierung unseres Webangebots.</p>
              <p><strong>Rechtsgrundlage:</strong> Ihre ausdr√ºckliche Einwilligung (Art. 6 Abs. 1 lit. a DSGVO).</p>
              <p>Details dar√ºber, wie Google Daten von Websites verwendet, auf denen unsere Tags zum Einsatz kommen, finden Sie hier: <a href="https://policies.google.com/technologies/partner-sites">Partner Sites</a>.</p>
              <p>Informationen zum Datenschutz bei Google Analytics finden Sie hier: <a href="https://support.google.com/analytics/answer/7318509?hl=en">Safeguarding your data</a>.</p>
            </li>
            <li>
              <strong>Pflichtangaben nach Art. 13 DSGVO</strong>
              <p><strong>Speicherdauer:</strong> Wir speichern personenbezogene Daten nur so lange, wie es f√ºr den jeweiligen Zweck (z. B. Web-Hosting oder Analyse) erforderlich ist, sofern keine gesetzlichen Aufbewahrungspflichten entgegenstehen.</p>
              <p><strong>Empf√§nger der Daten:</strong> Empf√§nger der Daten sind die oben genannten Dienstleister (GitHub, Google), mit denen entsprechende Auftragsverarbeitungsvertr√§ge (AVV) gem√§√ü Art. 28 DSGVO geschlossen wurden.</p>
              <p><strong>Ihre Rechte:</strong> Sie haben das Recht auf Auskunft, Berichtigung, L√∂schung und Einschr√§nkung der Verarbeitung Ihrer Daten sowie das Recht auf Daten√ºbertragbarkeit und das Recht, Einwilligungen jederzeit zu widerrufen.</p>
              <p><strong>Beschwerderecht bei der Aufsichtsbeh√∂rde:</strong> Sie haben das Recht, sich bei einer Datenschutz-Aufsichtsbeh√∂rde √ºber die Verarbeitung Ihrer Daten durch uns zu beschweren (z. B. beim Bayerischen Landesamt f√ºr Datenschutzaufsicht ‚Äì BayLDA).</p>
              <p><strong>Stand:</strong> 29. Januar 2026</p>
            </li>
          </ol>
        </div>
      </div>
    </div>
    <div class="consent-banner" id="consent-banner" role="dialog" aria-live="polite" aria-label="Cookie consent">
      <div class="consent-text">
        Google Analytics 4 collects pseudonymous information such as site traffic to help improve site content. For more details, see the <button class="consent-link" type="button" id="consent-privacy-link">Privacy Policy</button> and <a href="https://policies.google.com/technologies/partner-sites">Google‚Äôs Data Usage Policy</a>.
      </div>
      <div class="consent-actions">
        <button class="consent-button consent-decline" id="consent-decline" type="button">Decline</button>
        <button class="consent-button consent-accept" id="consent-accept" type="button">Accept</button>
      </div>
    </div>
    <script>
      // Analytics consent (Google Consent Mode)
      const GA_TRACKING_ID = 'G-N20KYCQTQ3';
      const CONSENT_KEY = 'ga_consent';

      function loadAnalytics() {
        if (window.__gaLoaded) return;
        window.__gaLoaded = true;
        const script = document.createElement('script');
        script.async = true;
        script.src = `https://www.googletagmanager.com/gtag/js?id=${GA_TRACKING_ID}`;
        document.head.appendChild(script);

        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        window.gtag = gtag;

        // Default to denied so GA runs in consent mode
        gtag('consent', 'default', {
          ad_storage: 'denied',
          analytics_storage: 'denied'
        });
        gtag('js', new Date());
        gtag('config', GA_TRACKING_ID, { anonymize_ip: true });
      }

      function setConsent(value) {
        try {
          localStorage.setItem(CONSENT_KEY, value);
        } catch (error) {
          // Ignore storage errors
        }
      }

      function getConsent() {
        try {
          return localStorage.getItem(CONSENT_KEY);
        } catch (error) {
          return null;
        }
      }

      function hideConsentBanner() {
        const banner = document.getElementById('consent-banner');
        if (banner) {
          banner.classList.add('is-hidden');
        }
      }

      function showConsentBanner() {
        const banner = document.getElementById('consent-banner');
        if (banner) {
          banner.classList.remove('is-hidden');
        }
      }

      function applyConsent(value) {
        if (!window.gtag) return;
        if (value === 'accepted') {
          gtag('consent', 'update', {
            ad_storage: 'denied',
            analytics_storage: 'granted'
          });
        } else {
          gtag('consent', 'update', {
            ad_storage: 'denied',
            analytics_storage: 'denied'
          });
        }
      }

      const storedConsent = getConsent();
      loadAnalytics();
      if (storedConsent === 'accepted') {
        applyConsent('accepted');
        hideConsentBanner();
      } else if (storedConsent === 'declined') {
        applyConsent('declined');
        hideConsentBanner();
      } else {
        showConsentBanner();
      }

      const consentAccept = document.getElementById('consent-accept');
      const consentDecline = document.getElementById('consent-decline');
      const consentPrivacyLink = document.getElementById('consent-privacy-link');
      if (consentAccept) {
        consentAccept.addEventListener('click', function() {
          setConsent('accepted');
          applyConsent('accepted');
          hideConsentBanner();
        });
      }
      if (consentDecline) {
        consentDecline.addEventListener('click', function() {
          setConsent('declined');
          applyConsent('declined');
          hideConsentBanner();
        });
      }
      if (consentPrivacyLink) {
        consentPrivacyLink.addEventListener('click', function() {
          openLegalPane();
        });
      }

      // Obfuscate address text with JS (render to image)
      const addressImage = document.getElementById('address-obfuscated');
      if (addressImage) {
        const addressText = 'Guy Gafni, Hornstr. 2, 80797 M√ºnchen, Deutschland';
        const canvas = document.createElement('canvas');
        const context = canvas.getContext('2d');
        const fontSize = 14;
        const fontFamily = 'Lato, Verdana, Helvetica, sans-serif';
        context.font = `${fontSize}px ${fontFamily}`;
        const textWidth = Math.ceil(context.measureText(addressText).width);
        const padding = 2;
        canvas.width = textWidth + padding * 2;
        canvas.height = fontSize + padding * 2;
        context.font = `${fontSize}px ${fontFamily}`;
        context.fillStyle = '#4b5b6b';
        context.textBaseline = 'top';
        context.fillText(addressText, padding, padding);
        addressImage.src = canvas.toDataURL('image/png');
      }

      // Obfuscate email text with JS (render to image)
      const emailImage = document.getElementById('email-obfuscated');
      if (emailImage) {
        const emailText = 'gafniguy@gmail.com';
        const canvas = document.createElement('canvas');
        const context = canvas.getContext('2d');
        const fontSize = 14;
        const fontFamily = 'Lato, Verdana, Helvetica, sans-serif';
        context.font = `${fontSize}px ${fontFamily}`;
        const textWidth = Math.ceil(context.measureText(emailText).width);
        const padding = 2;
        canvas.width = textWidth + padding * 2;
        canvas.height = fontSize + padding * 2;
        context.font = `${fontSize}px ${fontFamily}`;
        context.fillStyle = '#4b5b6b';
        context.textBaseline = 'top';
        context.fillText(emailText, padding, padding);
        emailImage.src = canvas.toDataURL('image/png');
      }

      // Legal pane controls
      const legalPane = document.getElementById('legal-pane');
      const legalPaneClose = document.getElementById('legal-pane-close');
      const legalLink = document.getElementById('legal-link');

      function openLegalPane() {
        legalPane.classList.add('is-open');
        legalPane.setAttribute('aria-hidden', 'false');
      }

      function closeLegalPane() {
        legalPane.classList.remove('is-open');
        legalPane.setAttribute('aria-hidden', 'true');
      }

      if (legalLink) {
        legalLink.addEventListener('click', openLegalPane);
      }

      if (legalPaneClose) {
        legalPaneClose.addEventListener('click', closeLegalPane);
      }
      if (legalPane) {
        legalPane.addEventListener('click', function(event) {
          if (event.target === legalPane) {
            closeLegalPane();
          }
        });
      }
      document.addEventListener('keydown', function(event) {
        if (event.key === 'Escape') {
          closeLegalPane();
        }
      });

      // Function to fetch citation count from Google Scholar (with fallbacks)
      async function fetchCitationCount(citationId, badgeId) {
        const scholarUrl = `https://scholar.google.com/citations?view_op=view_citation&hl=en&user=PATfNhwAAAAJ&citation_for_view=${citationId}`;
        const proxyUrls = [
          'https://api.allorigins.win/get?url=',
          'https://r.jina.ai/http://r.jina.ai/http://'
        ];
        const cacheKey = `citations:${citationId}`;

        function updateBadge(count, isFallback) {
          const badge = document.getElementById(badgeId);
          if (!badge) return;
          if (count) {
            badge.src = `https://img.shields.io/badge/Citations-${count}-blue`;
            badge.alt = `Citations: ${count}${isFallback ? ' (cached)' : ''}`;
          } else {
            badge.src = 'https://img.shields.io/badge/Citations-N%2FA-lightgrey';
            badge.alt = 'Citations: N/A';
          }
        }

        function parseCitationCount(html) {
          const match = html && html.match(/Cited by (\d+)/);
          return match && match[1] ? match[1] : null;
        }

        function readCachedCount() {
          try {
            const cached = localStorage.getItem(cacheKey);
            if (!cached) return null;
            const parsed = JSON.parse(cached);
            if (!parsed || !parsed.count) return null;
            const maxAgeMs = 1000 * 60 * 60 * 24 * 14;
            if (Date.now() - parsed.timestamp > maxAgeMs) return null;
            return parsed.count;
          } catch (error) {
            return null;
          }
        }

        function writeCachedCount(count) {
          try {
            localStorage.setItem(cacheKey, JSON.stringify({ count, timestamp: Date.now() }));
          } catch (error) {
            // Ignore cache failures
          }
        }

        const cachedCount = readCachedCount();
        if (cachedCount) {
          updateBadge(cachedCount, true);
        }

        for (const proxyUrl of proxyUrls) {
          try {
            const response = await fetch(proxyUrl + encodeURIComponent(scholarUrl));
            const data = await response.text();
            const html = proxyUrl.includes('allorigins') ? JSON.parse(data).contents : data;
            const count = parseCitationCount(html);
            if (count) {
              updateBadge(count, false);
              writeCachedCount(count);
              return;
            }
          } catch (error) {
            // Try next proxy
          }
        }

        if (!cachedCount) {
          updateBadge(null, false);
        }
      }
      
      // Fetch citation counts when page loads
      window.addEventListener('DOMContentLoaded', function() {
        // Semantify: PATfNhwAAAAJ:d1gkVwhDpl0C
        fetchCitationCount('PATfNhwAAAAJ:d1gkVwhDpl0C', 'semantify-citation-badge');
        // 4D Facial Avatars: PATfNhwAAAAJ:u5HHmVD_uO8C
        fetchCitationCount('PATfNhwAAAAJ:u5HHmVD_uO8C', 'facial4d-citation-badge');
      });

      // Contact pane controls
      const contactButton = document.getElementById('contact-button');
      const contactPane = document.getElementById('contact-pane');
      const contactPaneClose = document.getElementById('contact-pane-close');

      function openContactPane() {
        contactPane.classList.add('is-open');
        contactPane.setAttribute('aria-hidden', 'false');
      }

      function closeContactPane() {
        contactPane.classList.remove('is-open');
        contactPane.setAttribute('aria-hidden', 'true');
      }

      if (contactButton && contactPane && contactPaneClose) {
        contactButton.addEventListener('click', openContactPane);
        contactPaneClose.addEventListener('click', closeContactPane);
        contactPane.addEventListener('click', function(event) {
          if (event.target === contactPane) {
            closeContactPane();
          }
        });
        document.addEventListener('keydown', function(event) {
          if (event.key === 'Escape') {
            closeContactPane();
          }
        });
      }
    </script>
  </body>
</html>
